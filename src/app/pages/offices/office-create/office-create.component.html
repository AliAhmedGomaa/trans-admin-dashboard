<div class="office-create">
  <div class="header">
    <div class="title">{{ editingId ? 'ุชุนุฏูู ููุชุจ' : 'ููุชุจ ุฌุฏูุฏ' }}</div>
    <div class="actions">
      <button class="btn btn-primary" (click)="submit()" [disabled]="loading">
        {{ editingId ? 'ุชุนุฏูู' : 'ุงุถุงูุฉ' }}
      </button>
      <button class="btn btn-danger-outline" (click)="goBack()">ุงูุบุงุก</button>
    </div>
  </div>

  <form [formGroup]="form" (ngSubmit)="submit()">
    <div class="card">
      <div class="card-title">ุงูููุชุจ</div>
      <div class="grid" [formGroup]="form">
        <app-general-input
          [label]="'ุงุณู ุงูููุชุจ ุจุงูุนุฑุจูุฉ'"
          formControlName="name"
          [errors]="form.get('name')?.errors"
          [isSubmitted]="isSubmitted"
        ></app-general-input>
        <app-general-input
          [label]="'ุงุณู ุงูููุชุจ ุจุงูุงูุญููุฒูุฉ'"
          formControlName="englishName"
          [errors]="form.get('englishName')?.errors"
          [isSubmitted]="isSubmitted"
        ></app-general-input>
        <app-general-input
          [label]="'ุฑูู ุงููุงุชู'"
          formControlName="phone"
          [errors]="form.get('phone')?.errors"
          [isSubmitted]="isSubmitted"
        ></app-general-input>
        <app-general-input
          [label]="'ุฑูู ุงูููุชุจ'"
          formControlName="officeNumber"
          [errors]="form.get('officeNumber')?.errors"
          [isSubmitted]="isSubmitted"
        ></app-general-input>
        <app-general-input
          [label]="'ูุฏูุฑ ุงูููุชุจ'"
          formControlName="manager"
          [errors]="form.get('manager')?.errors"
          [isSubmitted]="isSubmitted"
        ></app-general-input>
        <app-general-input
          [label]="'ุงูุฑูู ุงูุชุฌุงุฑู'"
          formControlName="commercialRegisterNumber"
          [errors]="form.get('commercialRegisterNumber')?.errors"
          [isSubmitted]="isSubmitted"
        ></app-general-input>
      </div>
    </div>

    <div class="card">
      <div class="card-title">ุงูุนููุงู</div>
      <div class="grid" [formGroup]="form">
        <app-general-input
          [label]="'ุนููุงู ุงููุฑุน'"
          formControlName="address"
          [errors]="form.get('address')?.errors"
          [isSubmitted]="isSubmitted"
        ></app-general-input>
        <app-general-input
          [label]="'ุงููุฏููุฉ'"
          formControlName="city"
          [errors]="form.get('city')?.errors"
          [isSubmitted]="isSubmitted"
        ></app-general-input>
      </div>
    </div>

    <div class="card">
      <div class="card-title">ูุนูููุงุช ุงูุจูู</div>
      <div class="grid" [formGroup]="$any(form.get('bankingInfo'))">
        <app-general-input
          [label]="'ุงุณู ุงูุจูู'"
          formControlName="bankName"
          [isSubmitted]="isSubmitted"
          [errors]="form.get('bankingInfo.bankName')?.errors"
        ></app-general-input>
        <app-general-input
          [label]="'ุงุณู ุงูุญุณุงุจ'"
          formControlName="accountName"
          [isSubmitted]="isSubmitted"
          [errors]="form.get('bankingInfo.accountName')?.errors"
        ></app-general-input>
        <app-general-input
          [label]="'ุฑูู ุงูุงูุจุงู (IBAN)'"
          formControlName="ibanNumber"
          [isSubmitted]="isSubmitted"
          [errors]="form.get('bankingInfo.ibanNumber')?.errors"
        ></app-general-input>
        <app-general-input
          [label]="'ุฑูู ุงูุญุณุงุจ'"
          formControlName="accountNumber"
          [isSubmitted]="isSubmitted"
          [errors]="form.get('bankingInfo.accountNumber')?.errors"
        ></app-general-input>
      </div>
    </div>

    <div class="card">
      <div class="card-title">ุงููููุน</div>
      <div class="grid" [formGroup]="form">
        <button
          type="button"
          class="btn btn-primary"
          (click)="openLocationPicker()"
        >
          ุงุฎุชุฑ ุงููููุน
        </button>
      </div>
      <div class="grid" class="mt-4">
        <label class="flex flex-col gap-2">
          <span>{{ "COMMON.LOGO" | translate }}</span>
        </label>
        <div
          class="upload-zone"
          [class.dragging]="isDragging"
          (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)"
          (drop)="onDrop($event)"
        >
          <div class="upload-zone__content">
            <div class="upload-zone__icon">๐ค</div>
            <div class="upload-zone__title">ุงุณุญุจ ุงูููู ุฃู ุชุตูุญ ุฌูุงุฒู</div>
            <div class="upload-zone__hint">
              ูุฌุจ ุฃู ูููู ุงูููู ุจุตูุบุฉ png, jpg, doc, pdf ููุง ูุชุนุฏู ุญุฌูู 5MB
            </div>
            <div class="upload-zone__actions">
              <button
                type="button"
                class="btn btn-light"
                (click)="logoInput.click()"
              >
                ุชุตูุญ ูููููุงุช
              </button>
              <input
                #logoInput
                type="file"
                style="display: none"
                (change)="onLogoChange($event)"
              />
            </div>
            <div class="upload-zone__file" *ngIf="logoFile">
              {{ logoFile.name }}
            </div>
            <div class="upload-zone__error" *ngIf="logoError">
              {{ logoError }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="location-modal" *ngIf="showLocationModal">
      <div
        class="location-modal__overlay"
        (click)="closeLocationPicker()"
      ></div>
      <div class="location-modal__content">
        <div class="location-modal__header">
          <div class="location-modal__title">ุงุฎุชุฑ ุงููููุน</div>
          <button type="button" class="close" (click)="closeLocationPicker()">
            ร
          </button>
        </div>
        <div class="location-modal__map-wrapper">
          <div class="location-modal__search">
            <input
              #modalSearchInput
              type="text"
              placeholder="ุงูุชุจ ุงูุนููุงู ูุงุฎุชุฑ"
            />
          </div>
          <div #mapContainer class="location-modal__map"></div>
        </div>
        <div class="location-modal__footer">
          <button type="button" class="btn" (click)="closeLocationPicker()">
            ุงูุบุงุก
          </button>
          <button
            type="button"
            class="btn btn-primary"
            (click)="confirmLocation()"
          >
            ุชุญุฏูุฏ
          </button>
        </div>
      </div>
    </div>
  </form>
</div>
